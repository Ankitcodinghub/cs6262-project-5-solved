# cs6262-project-5-solved
**TO GET THIS SOLUTION VISIT:** [CS6262 Project 5 Solved](https://www.ankitcodinghub.com/product/cs6262-project-5-machine-learning-solved/)


---

üì© **If you need this solution or have special requests:** **Email:** ankitcoding@gmail.com  
üì± **WhatsApp:** +1 419 877 7882  
üìÑ **Get a quote instantly using this form:** [Ask Homework Questions](https://www.ankitcodinghub.com/services/ask-homework-questions/)

*We deliver fast, professional, and affordable academic help.*

---

<h2>Description</h2>



<div class="kk-star-ratings kksr-auto kksr-align-center kksr-valign-top" data-payload="{&quot;align&quot;:&quot;center&quot;,&quot;id&quot;:&quot;114803&quot;,&quot;slug&quot;:&quot;default&quot;,&quot;valign&quot;:&quot;top&quot;,&quot;ignore&quot;:&quot;&quot;,&quot;reference&quot;:&quot;auto&quot;,&quot;class&quot;:&quot;&quot;,&quot;count&quot;:&quot;3&quot;,&quot;legendonly&quot;:&quot;&quot;,&quot;readonly&quot;:&quot;&quot;,&quot;score&quot;:&quot;5&quot;,&quot;starsonly&quot;:&quot;&quot;,&quot;best&quot;:&quot;5&quot;,&quot;gap&quot;:&quot;4&quot;,&quot;greet&quot;:&quot;Rate this product&quot;,&quot;legend&quot;:&quot;5\/5 - (3 votes)&quot;,&quot;size&quot;:&quot;24&quot;,&quot;title&quot;:&quot;CS6262 Project 5  Solved&quot;,&quot;width&quot;:&quot;138&quot;,&quot;_legend&quot;:&quot;{score}\/{best} - ({count} {votes})&quot;,&quot;font_factor&quot;:&quot;1.25&quot;}">

<div class="kksr-stars">

<div class="kksr-stars-inactive">
            <div class="kksr-star" data-star="1" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="2" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="3" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="4" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="5" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>

<div class="kksr-stars-active" style="width: 138px;">
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>
</div>


<div class="kksr-legend" style="font-size: 19.2px;">
            5/5 - (3 votes)    </div>
    </div>
<strong>Goals of the Project</strong>

<ul>
<li>The goal of this project is to introduce students to machine learning techniques and methodologies that help to differentiate between malicious and legitimate network traffic.</li>
<li>In summary, students are introduced to:</li>
</ul>
‚óã how to build a machine-learning model based on normal network traffic.

‚óã how to conduct a blending attack producing artificial network traffic that resembles the normal one, and bypass the learned model.

<h1>Suggestion</h1>
We recommend you use the Linux VM provided. However, in the past, students faced no difficulty in setting up the project and working on either Windows or Macintosh OS.

<h1>Readings and Resources</h1>
This project relies on the following readings:

<ul>
<li><a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">‚ÄúAnomalous</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">Payload-based</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">Worm</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">Detection</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">and</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">Signature</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">Generation‚Äù,</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">Ke</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">Wang</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">and </a><a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">Salvatore</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">Stolfo,</a> <a href="https://cs.fit.edu/~pkc/id/related/wang05raid.pdf">RAID2004</a></li>
<li><a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">‚ÄúPolymorphic</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Blending</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Attacks‚Äù,</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Prahlad</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Fogla,</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Monirul</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Sharif,</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Roberto</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Perdisci,</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Oleg</a></li>
</ul>
<a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Kolesnikov,</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Wenke</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Lee,</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Usenix</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">Security</a> <a href="http://wenke.gtisc.gatech.edu/papers/usenix_security_2006.pdf">2006 </a>‚óè <a href="https://en.wikipedia.org/wiki/Sensitivity_and_specificity">‚ÄúSensitivity</a> <a href="https://en.wikipedia.org/wiki/Sensitivity_and_specificity">and</a> <a href="https://en.wikipedia.org/wiki/Sensitivity_and_specificity">specificit</a><a href="https://en.wikipedia.org/wiki/Sensitivity_and_specificity">y‚Äù</a>

<h1><u>Section 1: Project Quiz (5 points)</u></h1>
We have created a small quiz to help you understand the topics covered in this project. <strong>Please read the papers (under Readings and Resources) before attempting the quiz and the subsequent tasks</strong>.

<ol>
<li>In 1-gram PAYL, the byte frequency is calculated by counting the number of occurrences of a particular byte and dividing it by the length of the payload.
<ol>
<li>True</li>
<li>False</li>
</ol>
</li>
<li>The threshold for Mahalanobis distance is used to determine if the current payload is normal or malicious. Specifically, if the Mahalanobis distance of the current payload is LESS than the threshold, the current payload is malicious and an alert is raised by PAYL.
<ol>
<li>True</li>
<li>False</li>
</ol>
</li>
<li>Since polymorphic blending attacks try to evade network anomaly-based intrusion detection systems (IDS) by making the attacks look like normal traffic, they can be viewed as a subclass of mimicry attacks.
<ol>
<li>True</li>
<li>False</li>
</ol>
</li>
<li>In polymorphic blending attacks, the attacker uses an artificial profile which can be defined as:
<ol>
<li>The attack payload‚Äôs profile which can bypass the IDS</li>
<li>The profile of the payload generated by the polymorphic decryptor</li>
<li>The profile estimated by observing normal traffic</li>
<li>None of the above</li>
</ol>
</li>
<li>Polymorphic blending attacks use the following basic steps: (1) Blend the attack body within an instance of normal traffic payload and create an artificial payload using polymorphic encryption, (2) Let the IDS analyse this artificial payload and monitor the response received from IDS (3) Based on the response received repeat step 1 with another instance of normal traffic payload. Repeat until you find an artificial payload that can evade the IDS.
<ol>
<li>True</li>
<li>False</li>
</ol>
</li>
</ol>
<h2><strong>1.1: Deliverables</strong></h2>
For each question, please enter your option in <strong>answers.txt </strong>as shown in the sample file below. You will deliver <strong>answers.txt </strong>for this part.

You can find <strong>answers.txt </strong>under the project directory.

<h2>Section 2: Project Setup</h2>
You can either use the provided VM to complete the project <strong>OR </strong>you can set up your own environment locally.

<h3><u>2.1: VM Setup</u></h3>
<ol>
<li>Download the VM using one of the links provided in the project description on canvas. (The password for the VM is cs6262).</li>
<li>All the required packages/dependencies are already installed in the VM. The project files are under:</li>
</ol>
<strong>Desktop -&gt; project 5</strong>

<h3><u>2.2: Local Setup</u></h3>
<ol>
<li>Download the project zip file from the link provided in the project description on Canvas.</li>
<li>Please refer SETUP.txt in the PAYL directory to install the dependencies, using the same versions specified in the SETUP.txt.</li>
</ol>
The local setup is tested on Ubuntu 18.04 and Ubuntu 20.04. Please use Ubuntu 18.04 if possible. A step by step recording of how to set up the local environment can be found <a href="https://asciinema.org/a/A2AuqaiYOWI6SzIRuII59scCy">here</a>.

<strong>TIP: </strong>Even if you are using the provided VM, please check <strong>SETUP.txt </strong>to understand how the project is set up and to get an overview of the various code components in the project. This might help in debugging any issues you might face later.

<h2>Section 3: Project Tasks (95 points)</h2>
<strong>3.1: Task A ‚Äì (</strong><strong>17.5 </strong><strong>points)</strong>

<h3><u>3.1.1: Preliminary Reading</u></h3>
Please refer to the reference readings to learn about how PAYL model works, in particular,

<ol>
<li>how to extract byte frequency from the data</li>
<li>how to train the model</li>
<li>the definitions of parameters, threshold and smoothing factor</li>
</ol>
<strong>3.1.2: Code and data provided</strong>

The <strong>PAYL directory </strong>provides the PAYL code and data for model training.

<h3><u>3.1.3: PAYL Code Workflow</u></h3>
Here is the workflow of the provided PAYL code:

<ul>
<li>Operates in 2 modes:
<ol>
<li>training mode: It reads pcap files provided in the ‚Äòdata‚Äô directory, and tests parameters and reports the True Positive rates.</li>
<li>testing mode: It first builds a model using parameters and data specified in the directory. Then it will test a specific packet and decide whether the test packet fits the model.</li>
</ol>
</li>
<li>Training mode</li>
</ul>
‚óã Read the normal traffic data and divide it into two parts, 75% of the data for training and the rest 25% for testing (NOTE: <strong>You will NOT change these portions in the code</strong>).

‚óã Sort the payload strings by length and generate a model for each length.

‚óã Each model per length is based on <em>[mean frequency of each ascii, standard deviation of frequencies for each ascii].</em>

<strong>To run PAYL in training mode</strong>

$ python3 wrapper.py

<h4>Testing mode</h4>
<ul>
<li>Read the normal traffic data from the directory, and train a model using specific parameters. Then test the specific packet (fed from the command line) using the trained model.</li>
<li>Compute the Mahalanobis distance between each test payload and the model (of the same length)</li>
<li>Label the payload: If the Mahalanobis distance is below the specified threshold, label the payload as normal traffic. Otherwise, label the packet as attack traffic.</li>
</ul>
<h4>To run PAYL in testing mode</h4>
$ python3 wrapper.py [FILE.pcap]

where FILE.pcap is the data you will test.

<h3><u>3.1.4: Tasks ‚Äì Conduct experiments to select parameters</u></h3>
<ul>
<li>You are provided with artificial payloads (normal network traffic) to train a PAYL model.</li>
<li>After reading the reference papers, it should make sense that you cannot train the PAYL model on the entire traffic of different protocols. So first you need to <strong>select a protocol: a) HTTP or b) DNS by changing the hard-coded option in py</strong><strong>.</strong></li>
<li>The next step is to select a proper pair of parameters for the model. For the selection process, you will provide a range for both parameters (by modifying the threshold and smoothing factor in wrapper.py). Then run wrapper.py on training mode and make sure the normal traffic (artificial payloads stored in the default data folder) is fed while training.</li>
<li>The code will output the statistics for the parameters in the range. As shown in the figure below, for each pair of parameters, you will observe a True Positive Rate. <strong>You need to report a pair of parameters <u>(mSF and mTmd) </u>output by the code that achieves True Positive rate of <u>96% </u>or more. </strong>More than 99% true positive rate is possible and you may find multiple pairs of parameters that can achieve that.</li>
</ul>
The figure shows a sample output from the wrapper.py. You will find mSF and mTMD values which make mTP&gt;96% for both HTTP and DNS protocols respectively. The parameters can be different for the two protocols.

<h3><u>3.1.5: Deliverables</u></h3>
Please report for each protocol that you used, the parameters that you found (output by wrapper.py) in a file named <strong>parameters.txt</strong>. Please report a decimal <strong>with 2-digit accuracy </strong>for each parameter.

<strong>NOTE: </strong>You are given a sample <strong>parameters.txt </strong>with dummy values in the <strong>PAYL directory</strong>. Please update the relevant values with your own answer. Check section 4 for more details.

<strong>NOTE: </strong>The value for ‚Äú<strong>DISTANCE</strong>‚Äù in <strong>parameters.txt </strong>will be obtained in the next task (section 3.2).

<table width="605">
<tbody>
<tr>
<td colspan="2" width="605"><strong>TIP: </strong>You can set lower and upper bound values of both parameters in wrapper.py as the values</td>
</tr>
<tr>
<td width="487">you found in training mode to avoid multiple iterations during the testing mode.</td>
<td width="119"></td>
</tr>
</tbody>
</table>
<h3><u>3.2: Task B ‚Äì (</u><u>17.5 </u><u>points)</u></h3>
<strong>Download your unique attack payload [YOUR_GTUSERNAME.pcap] from Files in Canvas. (</strong><strong>Path: Files -&gt; Projects -&gt; Project Five -&gt; student_pcaps_Summer_2023)</strong>

For this part, your task is to examine the parameters you chose in Task A. Once the parameters are fixed, make sure the attack data does not fit the model, while the artificial ones (normal network traffic) fit. If such properties do not hold, you may want to redo Task A to modify the parameters to fulfill the requirements for both Task A and Task B. This procedure is essential for demonstrating the polymorphic blending attack in Task C.

<h4>Use PAYL in testing mode</h4>
<ul>
<li>You will first test your unique attack payload for both HTTP and DNS protocols ( <strong>NOTE: DO NOT forget to change <u>Smoothing Factor a</u>nd <u>Threshold </u>for Mahalanobis Distance when you change the protocol</strong>).</li>
<li>Verify that your attack payload gets <strong>rejected </strong>for both protocols. By rejected, we mean that you will get the ‚Äú<strong>It doesn‚Äôt fit the model</strong>‚Äù message on your test screen as presented in the following figure.</li>
<li>Then verify the artificial payloads (normal traffic). We provide two artificial payloads; one for HTTP (http_artificial_profile.pcap) and one for DNS (dns_artificial_profile.pcap). Both are in the PAYL folder. Test each artificial payload against your model. That is, use the testing mode as explained above by giving each artificial payload as parameter. (NOTE: DO NOT forget to change parameters according to each protocol while testing relevant payload, e.g., DNS parameters to test dns_artificial_profile.pcap.) These should be <strong>accepted </strong>by the model. That is, you should get an output message that says ‚Äú<strong>It fits the model</strong>‚Äù as presented in the following figure.</li>
</ul>
<h4>3.2.1: Deliverables</h4>
Please report your calculated distance (mDISTANCE in the above figures) in <strong>parameters.txt </strong>for each protocol with the values of the <strong>attack payload (YOUR_GTUSERNAME.pcap) </strong>after completing Task B.

<strong>NOTE: </strong>You are given a sample <strong>parameters.txt </strong>with dummy values under <strong>PAYL directory</strong>. Please update the relevant values with your own answer. Check section 4 for more details.

<strong>3.3: Task C ‚Äì (</strong><strong>60 </strong><strong>points)</strong>

Preliminary reading. Please refer to the ‚ÄúPolymorphic Blending Attacks‚Äù paper. In particular, section 4.2 describes how to evade 1-gram and the model implementation. More specifically we are focusing on the case where m &lt;= n and the substitution is ONE-TO-MANY.

We assume that the attacker has a specific payload (attack payload) that she would like to blend in with the normal traffic. Also, we assume that the attacker has access to one packet (artificial profile payload) that is normal and is accepted as normal by the PAYL model.

The attacker‚Äôs goal is to transform the byte frequency of the attack traffic so that it matches the byte frequency of the normal traffic, and thus bypass the PAYL model. NOTE: Complete this task ONLY for the HTTP protocol.

Code provided: Please look at the <strong>Polymorphic_blend directory</strong>. All files (including attack payload) for this task should be in this directory. Hence, copy your unique attack payload also in this directory. <u>Rename ATTACKBODY_PATH in task1.py with your unique attack payload name (YOUR_GTUSERNAME.pcap).</u>

<h5>How to run the code</h5>
$ python3 task1.py

NOTE: You need to complete Task C before running task1.py.

<strong>Main function </strong><strong>task1.py </strong>contains all the functions that are called to transform the byte frequency of the attack traffic.

<h5>Output</h5>
<ul>
<li>The code should generate a new payload (filename: <strong>output</strong>) that can successfully bypass the PAYL model that you have found above (using your selected parameters in Task A and</li>
</ul>
B).

<ul>
<li>The new payload (<strong>output</strong>) is shellcode.bin + encrypted attack body + XOR table + padding. <strong>Please refer to the paper for full descriptions and definitions of shellcode, attack body, XOR table and padding. </strong> The shellcode is provided.</li>
</ul>
<h5>Substitution table</h5>
We provide the skeleton for the code needed to generate a substitution table, based on the byte frequency of attack payload and artificial profile payload. For the purpose of implementation, the substitution table can be e.g. a python dictionary table. We ask that you complete the code for the substitution function. The substitution is one-to-many. Skeleton code prints the substitution table to the console. You will deliver your substitution table in <strong>substitution_table.txt </strong>file in the following format.

NOTE: This is just an example to show the format of the table. Please ignore the frequency values.

NOTE: The substitution table should have the frequencies as observed in the normal payload. Please do <strong>NOT </strong>normalize these values in <strong>substitution_table.txt. </strong>You can normalize the values later during substitution in <strong>substitution.py.</strong>

<h5>Padding</h5>
Similarly, we have provided a skeleton for the padding function and we are asking you to complete the rest.

<h5>Main tasks</h5>
Please complete the code for the <strong>substitution.py </strong>and <strong>padding.py </strong>and then run <strong>task1.py </strong>to generate the new payload (<strong>output</strong>).

<h4>3.3.1: Deliverables</h4>
<ul>
<li>You will&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; deliver&nbsp;&nbsp; <strong>py</strong>, <strong>padding.py</strong>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; your&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; payload (<strong>output</strong>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and <strong>substitution_table.txt </strong>for this task.</li>
<li>You‚Äôre expected to <strong>write comments </strong>for your code. Otherwise, <strong>you will lose 5 points.</strong></li>
</ul>
<h4>Test your output</h4>
Test your new payload (output) against the PAYL model and <strong>verify that it is accepted</strong>. FP should be 100% indicating that the payload got accepted as legit, even though it is malicious. You should run as follows and observe the following output, and get the output message that says, ‚Äú<strong>It fits the model</strong>‚Äù.

<strong>TIP: </strong>Check the relevant FAQs in section 5.

<strong>IMPORTANT: Please check section 5.6 to understand how you can verify your code.</strong>

<h2>Section 4: Final deliverables and Rubric</h2>
<strong>Tasks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Deliverable Files</strong>

<table width="459">
<tbody>
<tr>
<td width="113">Project Quiz</td>
<td width="346"><strong>answers.txt</strong></td>
</tr>
<tr>
<td width="113">A &amp; B</td>
<td width="346"><strong>parameters.txt</strong></td>
</tr>
</tbody>
</table>
C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>substitution.py</strong>

<strong>padding.py substitution_table.txt output</strong>

<strong>Total: </strong><strong>6 files</strong>

<strong>Total points: </strong><strong>100</strong>

<strong>Please make sure to submit all of the files to Gradescope</strong><strong>. Do NOT ZIP your deliverable files.</strong>

<strong><u>4.1: Project Quiz ‚Äì 5 points</u></strong>

<h3>4.2: Task A ‚Äì 17.5 points</h3>
Please report (for each protocol) the parameters that you found in a file named <strong>parameters.txt</strong>. <strong>Please report a decimal with 2 digit accuracy for each parameter</strong>.

<h3>4.3: Task B ‚Äì 17.5 points</h3>
Please report your calculated distance (mDISTANCE in the above figures) in <strong>parameters.txt </strong>for each protocol with the values of the attack payload after completing Task B.

<strong>parameters.txt </strong>format:

<strong>|</strong><strong>Protocol:HTTP</strong><strong>|</strong>

<strong>|</strong><strong>Threshold:1111.00</strong><strong>|</strong>

<strong>|</strong><strong>SmoothingFactor:0.01</strong><strong>|</strong>

<strong>|</strong><strong>TruePositiveRate:50.00</strong><strong>|</strong>

<strong>|</strong><strong>Distance:2000.00</strong><strong>|</strong>

<strong>|</strong><strong>Protocol:DNS</strong><strong>|</strong>

<strong>|</strong><strong>Threshold:2222.00</strong><strong>|</strong>

<strong>|</strong><strong>SmoothingFactor:0.00</strong><strong>|</strong>

<strong>|</strong><strong>TruePositiveRate:50.00</strong><strong>|</strong>

<strong>|</strong><strong>Distance:2000.00</strong><strong>|</strong>

<strong>NOTE: </strong>You are given a sample <strong>parameters.txt </strong>with <strong>dummy values </strong>under PAYL directory. Please update each value with your own answer. <strong>Those values should only come from the PAYL script‚Äôs output to the console. (not from the values modified inside the script).</strong>

<h4>Description of fields in parameters.txt</h4>
<strong><em>|Protocol:HTTP|</em></strong>

<strong><em>|Threshold:1111.00|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Part A</em></strong>

<strong><em>|SmoothingFactor 0.01| // Part A</em></strong>

<strong><em>|TruePositiveRate:50.00| // Part A</em></strong>

<strong><em>|Distance:20020.00| // Part B, mDISTANCE this is the mDISTANCE value that you get from your unique pcap file (python wrapper.py &lt;yourunique.pcap&gt;)</em></strong>

<strong><em>|Protocol:DNS|</em></strong>

<strong><em>|Threshold:2222.00|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Part A</em></strong>

<strong><em>|SmoothingFactor:0.00| // Part A</em></strong>

<strong><em>|TruePositiveRate:50.00| // Part A</em></strong>

<strong><em>|Distance:22000.00| // Part B, mDISTANCE this is the mDISTANCE value that you get from your unique pcap file (python wrapper.py &lt;yourunique.pcap&gt;)</em></strong>

NOTE: <strong>‚Äú0.3‚Äù should be entered as ‚Äú0.30‚Äù. ‚Äú2‚Äù should be entered as ‚Äú2.00‚Äù.</strong>

<h3>4.4: Task C ‚Äì 60 points</h3>
Please submit the following files: <strong>substitution.py</strong>,and <strong>padding.py</strong>, and your <strong>substitution_table.txt</strong>, and the <strong>output </strong>of Task C (generated as a new file after running task1.py). This output is <strong><u>very important </u></strong>and represents a significant portion of the points for Task C.

<strong><u>4.5: !! Important Notes (Please check before submission) !!</u></strong>

<ul>
<li>Every file name with the wrong name and/or extension will be penalized with 5 points.</li>
<li><strong>Do NOT ZIP your deliverable files. You will lose 5 points for zipped files.</strong></li>
<li>Follow the format for substitution_table.txt above (section 3.3), for the wrong format you will lose 5 points.</li>
<li>Follow the format for parameters.txt above, for the wrong format you will lose 5 points.</li>
<li>Do not forget to update your parameters.txt If you submit sample parameters.txt with dummy values, you will get 0/35 for Task A and B. We won‚Äôt accept resubmission after the due date.</li>
<li><strong>You should complete Task A, B and C with the same set of parameters. If your output doesn‚Äôt pass the model with parameters in your parameters.txt you will get 0/20 for output.</strong></li>
<li>For Task B, in parameters.txt you will report calculated distance after you provide your own attack payload. (i.e.YOUR_GTUSERNAME.pcap)</li>
<li>For Task C, You are allowed to import and use ‚Äúrandom‚Äù or ‚Äúnumpy‚Äù. Do NOT import any other libraries.</li>
<li><strong>If you don‚Äôt implement the correct algorithm for Task C, even if your output passes the model you won‚Äôt get full credit. We will not accept the implementation of ONE-ONE mapping</strong>. (Check section 5.2)</li>
<li>Don‚Äôt forget to put comments for your code. Otherwise, you will lose 5 points.</li>
</ul>
<h2>Section 5: FAQs</h2>
<h3>5.1: Task C clarifications</h3>
<ul>
<li>As we saw in part A+B, your unique attack payload does not fit the model. In Task C we want to make our pcap fit.</li>
<li>We care about our attack payload being turned into what a normal payload would look like.</li>
<li>We‚Äôre simply performing substitution and padding to match the character frequency and packet size.</li>
<li>We want to modify the various python functions to perform this substitution and padding for us.</li>
<li>After the functions have been crafted, copy the file it generates (output) over to your PAYL directory and test it (python3 wrapper.py output). You want it to fit the model.</li>
</ul>
<strong><u>5.2: How to implement Substitution Table &amp; Substitute?</u></strong>

First Refer to the ‚ÄúPolymorphic Blending Attacks‚Äù paper. In particular, section 4.2 describes how to evade 1-gram and the model implementation. More specifically we are focusing on the case where m &lt;= n and the substitution is ONE-TO-MANY.

<strong>NOTE: We will not accept the implementation of ONE-ONE mapping</strong>.

Refer to the example provided in the write-up (section 5.5).

After reading the paper and example, it should be obvious how to implement a substitution table. If you still have any specific questions you can post your questions on Ed discussion.

<h4>Substitution</h4>
Given an attack byte, find the mapping in your Substitution Table. You will have multiple choices because of how we constructed the table. Pick one based on the ratio of the bytes frequency to the sum of all frequencies. You have to normalize the frequencies to sum up to 1.

NOTE: You are allowed to import and use ‚Äúrandom or numpy‚Äù for this task. Do NOT import any other libraries.

<strong><u>5.3: How to implement Padding?</u></strong>

Find the byte with the largest byte frequency difference, say ‚Äòa‚Äô, and append ‚Äòa‚Äô to the raw_payload

(padding.py). Padding function is called repeatedly when len(raw_payload) &lt; len(artificial_payload) (as in task1.py).

So each time you only need to pad one byte when the padding function is called.

<h3>5.4: XOR and result Clarification in Task C</h3>
Both are lists of characters, where ‚Äòresult‚Äô keeps the replacement chars and ‚Äòxor‚Äô keeps the XOR of replacement and corresponding attack value.

From the sample in the write-up. Assume ‚Äòt‚Äô is replaced by ‚ÄòZ‚Äô then your result will include ‚ÄòZ‚Äô and xor table will include XOR(‚Äòt‚Äô,‚ÄôZ‚Äô)=‚Äô.‚Äô

<strong>NOTE: </strong>Be careful while XORing the chars

<strong>NOTE</strong><strong>: </strong>You substitution_table.txt should have the format we mentioned in the writeup.

<strong>NOTE: </strong>You need to verify your Task C and see your original packet content. (check section 5.6)

<h3>5.5: Simple example for substitution</h3>
<strong>Please refer to the ‚ÄòPolymorphic Blending Attack‚Äô: Substitution part</strong>

Example

# normal traffic <strong>(x) </strong>and attack traffic <strong>(y</strong>):

<strong>x = abbcccdddd, y = rrsss</strong>

# distinct characters in normal traffic <strong>(n) </strong>and attack body <strong>(m)</strong>:

<strong>n = 4, m = 2</strong>

# frequency of characters in normal traffic <strong>f(x) </strong>and attack body <strong>g(y)</strong>: <strong>f(x) = [(‚Äòd‚Äô, 0.4), (‚Äòc‚Äô, 0.3), (‚Äòb‚Äô, 0.2), (‚Äòa‚Äô, 0.1)] , g(y) = [(‚Äòs‚Äô, 0.6), (‚Äòr‚Äô, 0.4)]</strong>

For the first m characters in <strong>(x)</strong>, create a one-to-one mapping in both sets:

<strong>Let : t^f(y_j) = f(x_i) Then:</strong>

<strong>S(s) = [(‚Äòd‚Äô, 0.4)] S(r) = [(‚Äòc‚Äô, 0.3)] t^f(s) = 0.4 t^f(r) = 0.3</strong>

For the (m+1)th char, first find the attack character with max ratio of <strong>g(y_j)/t^f(y_j)</strong>:

<strong>g(s)/(t^f(s)) = 0.6/0.4 = 1.5 g(r)/(t^f(r)) = 0.4/0.3 = 1.33</strong>

So, the next attack character is <strong>‚Äòs‚Äô</strong>. Then, your substitution table at this step is:

<strong>S(s)= [(‚Äòd‚Äô, 0.4), (‚Äòb‚Äô,0.2)] S(r)= [(‚Äòc‚Äô, 0.3)</strong>]

and update:

<strong>t^f(s)=0.4+0.2=0.6</strong>

Repeat to find the next attack character and so on.

<strong>g(s) / (t^f(s)) = 0.6/0.6 = 1 g(r) / (t^f(r)) = 0.4/0.3 = 1.33</strong>

Now, the next attack character is <strong>‚Äòr‚Äô</strong>. Then, your substitution table at this step is

<strong>S(s)= [(‚Äòd‚Äô, 0.4), (‚Äòb‚Äô,0.2)]</strong>

<strong>S(r)= [(‚Äòc‚Äô, 0.3), (‚Äòa‚Äô,0.1)] </strong>and update:

<strong>t^f(r) = 0.3 + 0.1 = 0.4</strong>

After you finish the substitution, you are done with <strong>t^f(y_j)‚Äôs </strong>and you will make a substitution with the frequency weight of each character in the table.

s is substituted with:

<strong>d with a probability of 0.4/(0.4+0.2) b with a probability of 0.2/(0.4+0.2)</strong>

r is substituted with:

<strong>c with a probability of 0.3/(0.3+0.1) a with a probability of 0.1/(0.3+0.1)</strong>

It is up to you how you implement a weighted random assignment, but it is a trivial step.

<strong><u>5.6 How to verify Task C?</u></strong>

If you only have 64-bit compiler, you need to run the following:

$ sudo apt-get install lib32gcc-4.9-dev

$ sudo apt-get install gcc-multilib

<strong>NOTE: </strong>You can also verify Task C using lib32gcc-9-dev.

If you‚Äôre on Ubuntu Xenial, the one listed in the instructions should work: lib32gcc-4.9-dev

If you‚Äôre on Debian Buster or Ubuntu Bionic, try: lib32gcc-8-dev

If you‚Äôre on Ubuntu Cosmic or Disco, try: lib32gcc-9-dev

The 32 bit compiler is already installed in the VM.

Next, you need to generate your payload. So, somewhere near the end of task1.py add the following to create your payload.bin:

payload_file:

payload_file.write(bytearray(‚Äú‚Äù.join(adjusted_attack_body + xor_table), ‚Äúutf8‚Äù))

Now, run task1.py to generate <strong>payload.bin </strong>and once it‚Äôs generated, run the makefile with <strong>make </strong>and then run <strong>a.out</strong>:

$ make

$ ./a.out

<strong>If all is well, you should see your original packet contents. If not and you get a bunch of funny letters it didn‚Äôt work.</strong>

<strong>NOTE: </strong>It was only tested on Linux, you might need to make a few modifications according to your system configuration.

<h2>Section 6: Academic Integrity</h2>
<ul>
<li>All submitted code must be written by you.</li>
<li>Borrowing or adapting code from other students and websites like Stack Overflow, code repositories, and other sources is strictly forbidden.</li>
<li>You may not discuss specific solutions. Keep your discussions at a high level.</li>
<li>Sharing code is strictly forbidden.</li>
<li>Note that we will report you to the Office of Student Integrity if there is a violation.</li>
<li>As a reminder, please review the Georgia Tech Honor Code and the course policies outlined in the syllabus.</li>
</ul>
<strong>Good luck and have fun!!</strong>
